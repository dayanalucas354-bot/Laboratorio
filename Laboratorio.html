<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Lab 1 ‚Äì Crear una Clase</title>

<style>
:root {
  --primary: #2563eb;
  --success: #16a34a;
  --error: #dc2626;
  --bg: #f8fafc;
  --panel: #ffffff;
  --border: #e5e7eb;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: system-ui, Arial, sans-serif;
  height: 100vh;
  display: flex;
  background: var(--bg);
}

/* Paneles */
.panel {
  padding: 20px;
  overflow-y: auto;
}

#left {
  width: 30%;
  background: #f1f5f9;
  border-right: 1px solid var(--border);
}

#editor {
  width: 40%;
  background: var(--panel);
  border-right: 1px solid var(--border);
}

#right {
  width: 30%;
  background: var(--panel);
}

/* T√≠tulos */
h2, h3 {
  margin-top: 0;
  color: var(--primary);
}

/* Editor */
textarea {
  width: 100%;
  height: 80%;
  resize: none;
  font-family: Consolas, monospace;
  font-size: 14px;
  padding: 12px;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: #0f172a;
  color: #e5e7eb;
  transition: border 0.3s, background 0.3s;
}

/* Estados del editor */
textarea.error {
  border: 2px solid var(--error);
  background: #450a0a;
}

textarea.ok {
  border: 2px solid var(--success);
  background: #052e16;
}

/* Bot√≥n */
button {
  margin-top: 12px;
  width: 100%;
  padding: 12px;
  font-size: 15px;
  font-weight: bold;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

button:hover {
  opacity: 0.9;
}

/* Tests */
.test {
  margin: 6px 0;
  padding: 6px;
  border-radius: 4px;
  font-size: 14px;
}

.ok {
  color: var(--success);
}

.fail {
  color: var(--error);
}

/* Salida */
pre {
  background: #020617;
  color: #e5e7eb;
  padding: 12px;
  border-radius: 6px;
  min-height: 120px;
}
</style>
</head>

<body>

<!-- Panel izquierdo -->
<div id="left" class="panel">
  <h2>Lab 1: Crear una Clase</h2>

  <p><strong>Objetivo:</strong></p>
  <ul>
    <li>Crear una clase <strong>Persona</strong>.</li>
    <li>Definir los atributos <em>nombre</em> y <em>edad</em>.</li>
    <li>Implementar el m√©todo <strong>presentarse()</strong>.</li>
  </ul>

  <h3>Pruebas autom√°ticas</h3>
  <div id="test1" class="test">üî≤ La clase Persona existe.</div>
  <div id="test2" class="test">üî≤ Tiene los atributos nombre y edad.</div>
  <div id="test3" class="test">üî≤ Tiene el m√©todo presentarse().</div>

  <button onclick="runTests()">‚ñ∂ Ejecutar pruebas</button>
</div>

<!-- Editor -->
<div id="editor" class="panel">
  <h3>C√≥digo del estudiante</h3>
  <textarea id="code">
// Escribe tu c√≥digo aqu√≠
class Persona {
  constructor(nombre, edad) {
    this.nombre = nombre;
    this.edad = edad;
  }

  presentarse() {
    return `Hola, soy ${this.nombre} y tengo ${this.edad} a√±os`;
  }
}
  </textarea>
</div>

<!-- Panel derecho -->
<div id="right" class="panel">
  <h3>Salida</h3>
  <pre id="output">Ejecuta las pruebas para ver el resultado.</pre>
</div>

<script>
function resetTest(id) {
  const el = document.getElementById(id);
  el.classList.remove("ok", "fail");
}

function pass(id, text) {
  const el = document.getElementById(id);
  el.textContent = text;
  el.classList.add("ok");
}

function fail(id, text) {
  const el = document.getElementById(id);
  el.textContent = text;
  el.classList.add("fail");
}

function highlightErrorLine(textarea, lineNumber) {
  const lines = textarea.value.split("\n");
  if (!lines[lineNumber - 1]) return;
  lines[lineNumber - 1] = "‚ùå " + lines[lineNumber - 1];
  textarea.value = lines.join("\n");
}

function runTests() {
  const output = document.getElementById("output");
  const textarea = document.getElementById("code");

  textarea.classList.remove("error", "ok");
  output.textContent = "";

  resetTest("test1");
  resetTest("test2");
  resetTest("test3");

  try {
    const studentCode = textarea.value;

    const sandbox = {};
    const wrappedCode = `
      ${studentCode}

      if (typeof Persona !== "function") {
        throw new Error("Debes definir la clase Persona");
      }

      sandbox.Persona = Persona;
    `;

    new Function("sandbox", wrappedCode)(sandbox);

    const Persona = sandbox.Persona;
    const persona = new Persona("Ana", 20);

    pass("test1", "‚úî La clase Persona existe.");

    if ("nombre" in persona && "edad" in persona) {
      pass("test2", "‚úî Tiene los atributos nombre y edad.");
    } else {
      throw new Error("Los atributos nombre y edad son obligatorios");
    }

    if (typeof persona.presentarse === "function") {
      pass("test3", "‚úî Tiene el m√©todo presentarse().");
    } else {
      throw new Error("Debes crear el m√©todo presentarse()");
    }

    textarea.classList.add("ok");
    output.textContent =
      "‚úÖ Todo correcto\n\n" + persona.presentarse();

  } catch (e) {
    textarea.classList.add("error");

    let lineInfo = "";
    const match = e.stack && e.stack.match(/<anonymous>:(\d+):\d+/);

    if (match) {
      const lineNumber = parseInt(match[1]) - 2;
      lineInfo = ` (l√≠nea ${lineNumber})`;
      highlightErrorLine(textarea, lineNumber);
    }

    output.textContent =
      "‚ùå Error" + lineInfo + ":\n" + e.message;
  }
}
</script>

</body>
</html>

